<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jogo da velha</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      #game-container {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        backdrop-filter: blur(4px);
        border: 1px solid rgba(255, 255, 255, 0.18);
      }

      h1 {
        color: white;
        text-align: center;
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      #tic-tac-toe {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        gap: 10px;
      }

      .cell {
        width: 100px;
        height: 100px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 2.5em;
        cursor: pointer;
        transition: all 0.3s ease;
        color: white;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .cell:hover {
        background-color: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
      }

      .cell.x {
        color: #ffd700;
      }

      .cell.o {
        color: #00ffff;
      }

      #reset {
        display: block;
        margin: 20px auto 0;
        padding: 10px 20px;
        font-size: 1em;
        color: white;
        background-color: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      #reset:hover {
        background-color: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
      }

      #status {
        text-align: center;
        color: white;
        font-size: 1.2em;
        margin-top: 20px;
        height: 1.5em;
      }

      @keyframes win-animation {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      .win {
        animation: win-animation 0.5s ease-in-out;
      }
    </style>
  </head>
  <body>
    <div id="game-container">
      <h1>Tic Tac Toe</h1>
      <div id="tic-tac-toe">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
        <div class="cell" data-index="4"></div>
        <div class="cell" data-index="5"></div>
        <div class="cell" data-index="6"></div>
        <div class="cell" data-index="7"></div>
        <div class="cell" data-index="8"></div>
      </div>
      <button id="reset">Resetar Jogo</button>
      <div id="status"></div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const board = ["", "", "", "", "", "", "", "", ""];
        let currentPlayer = "X";
        const cells = document.querySelectorAll(".cell");
        const resetButton = document.getElementById("reset");
        const statusDisplay = document.getElementById("status");

        const winPatterns = [
          [0, 1, 2],
          [3, 4, 5],
          [6, 7, 8],
          [0, 3, 6],
          [1, 4, 7],
          [2, 5, 8],
          [0, 4, 8],
          [2, 4, 6],
        ];

        function makeMove(e) {
          const index = e.target.dataset.index;
          if (!board[index] && currentPlayer === "X") {
            playMove(index, "X");
            if (checkEnd("X")) return;
            currentPlayer = "O";
            statusDisplay.textContent = "Vez do computador";
            setTimeout(computerMove, 500);
          }
        }

        function playMove(index, player) {
          board[index] = player;
          cells[index].textContent = player;
          cells[index].classList.add(player.toLowerCase());
        }

        function computerMove() {
          const bestMove = getBestMove();
          playMove(bestMove, "O");
          if (checkEnd("O")) return;
          currentPlayer = "X";
          statusDisplay.textContent = `${currentPlayer}'Sua vez`;
        }

        function getBestMove() {
          let bestScore = -Infinity;
          let move;
          for (let i = 0; i < board.length; i++) {
            if (board[i] === "") {
              board[i] = "O";
              let score = minimax(board, 0, false);
              board[i] = "";
              if (score > bestScore) {
                bestScore = score;
                move = i;
              }
            }
          }
          return move;
        }

        function minimax(boardState, depth, isMaximizing) {
          const scores = { O: 10, X: -10, tie: 0 };
          const result = checkWinnerMinimax(boardState);
          if (result !== null) return scores[result];

          if (isMaximizing) {
            let bestScore = -Infinity;
            for (let i = 0; i < boardState.length; i++) {
              if (boardState[i] === "") {
                boardState[i] = "O";
                let score = minimax(boardState, depth + 1, false);
                boardState[i] = "";
                bestScore = Math.max(score, bestScore);
              }
            }
            return bestScore;
          } else {
            let bestScore = Infinity;
            for (let i = 0; i < boardState.length; i++) {
              if (boardState[i] === "") {
                boardState[i] = "X";
                let score = minimax(boardState, depth + 1, true);
                boardState[i] = "";
                bestScore = Math.min(score, bestScore);
              }
            }
            return bestScore;
          }
        }

        function checkWinnerMinimax(boardState) {
          for (let [a, b, c] of winPatterns) {
            if (
              boardState[a] &&
              boardState[a] === boardState[b] &&
              boardState[a] === boardState[c]
            ) {
              return boardState[a];
            }
          }
          if (boardState.every((cell) => cell !== "")) return "tie";
          return null;
        }

        function checkEnd(player) {
          if (checkWinner()) {
            highlightWinner();
            statusDisplay.textContent = `${player} wins!`;
            setTimeout(() => {
              if (player === "O") {
                resetGame("O");
              } else {
                resetGame("X");
              }
            }, 1500);
            return true;
          } else if (board.every((cell) => cell !== "")) {
            statusDisplay.textContent = "";
            setTimeout(() => resetGame("X"), 1500);
            return true;
          }
          return false;
        }

        function checkWinner() {
          return winPatterns.some(
            ([a, b, c]) =>
              board[a] && board[a] === board[b] && board[a] === board[c]
          );
        }

        function highlightWinner() {
          for (let [a, b, c] of winPatterns) {
            if (board[a] && board[a] === board[b] && board[a] === board[c]) {
              cells[a].classList.add("win");
              cells[b].classList.add("win");
              cells[c].classList.add("win");
            }
          }
        }

        function resetGame(starter = "X") {
          board.fill("");
          cells.forEach((cell) => {
            cell.textContent = "";
            cell.classList.remove("x", "o", "win");
          });
          currentPlayer = starter;
          statusDisplay.textContent = `${currentPlayer}'`;

          if (starter === "O") {
            setTimeout(computerMove, 500);
          }
        }

        cells.forEach((cell) => cell.addEventListener("click", makeMove));
        resetButton.addEventListener("click", () => resetGame("X"));

        statusDisplay.textContent = `${currentPlayer}'`;
      });
    </script>
  </body>
</html>
